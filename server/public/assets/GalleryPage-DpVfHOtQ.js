import{r as s,j as t,S as p}from"./index-5DV5qeFP.js";const k="https://phpstack-1537842-6027953.cloudwaysapps.com";function f(){const[l,g]=s.useState([]),[c,d]=s.useState(!0),[i,x]=s.useState(null),r=s.useCallback(async()=>{try{d(!0),x(null);const o=await fetch(`${k}/api/gallery`);if(!o.ok)throw new Error("Failed to load gallery");const m=await o.json();g(m)}catch(o){x(o)}finally{d(!1)}},[]);return s.useEffect(()=>{r()},[r]),{data:l,loading:c,error:i,refetch:r}}const y="https://phpstack-1537842-6027953.cloudwaysapps.com";function w(){const{data:l,loading:g,error:c,refetch:d}=f(),[i,x]=s.useState("newest"),[r,o]=s.useState("all"),m=s.useMemo(()=>{let e=[...l];switch(r!=="all"&&(e=e.filter(a=>a.type?.toLowerCase()===r.toLowerCase())),i){case"likes":e.sort((a,n)=>(n.like_count||0)-(a.like_count||0));break;case"name":e.sort((a,n)=>a.name.localeCompare(n.name));break}return e},[l,i,r]),h=s.useMemo(()=>{const e=new Set(l.map(a=>a.type).filter(Boolean));return Array.from(e).sort()},[l]),u=async e=>{try{if(!(await fetch(`${y}/api/pokaimon/${e}/like`,{method:"PATCH"})).ok)throw new Error("Failed to like");await d()}catch(a){console.error(a)}};return g?t.jsx(p,{label:"Loading gallery…"}):c?t.jsxs("div",{className:"text-red-500 dark:text-red-400",children:["Failed to load: ",String(c)]}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"PokAImon Gallery"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Sort:"}),t.jsxs("select",{value:i,onChange:e=>x(e.target.value),className:"px-3 py-1.5 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm",children:[t.jsx("option",{value:"newest",children:"Newest"}),t.jsx("option",{value:"likes",children:"Most Liked"}),t.jsx("option",{value:"name",children:"Name"})]})]}),h.length>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Type:"}),t.jsxs("select",{value:r,onChange:e=>o(e.target.value),className:"px-3 py-1.5 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm",children:[t.jsx("option",{value:"all",children:"All Types"}),h.map(e=>t.jsx("option",{value:e,children:e},e))]})]})]})]}),m.length===0?t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No generated PokAImon yet. Head to the Generator!"}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(e=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[t.jsx("img",{src:`${y}${e.image_url}`,alt:e.name,className:"w-full aspect-square object-contain"}),t.jsx("h3",{className:"text-xl font-semibold mt-3 text-gray-900 dark:text-white",children:e.name}),e.type&&t.jsx("span",{className:"inline-block mt-2 text-xs px-2 py-1 rounded bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-200",children:e.type}),e.characteristics&&t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-2",children:e.characteristics}),e.powers&&Array.isArray(e.powers)&&e.powers.length>0&&t.jsxs("div",{className:"mt-3 space-y-1",children:[t.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:"Powers:"}),e.powers.map((a,n)=>t.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),a.description&&t.jsxs("span",{children:[" - ",a.description]})]},n))]}),t.jsxs("button",{onClick:()=>u(e.id),className:"mt-3 w-full px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:["❤️ Like (",e.like_count||0,")"]})]},e.id))})]})}export{w as default};
