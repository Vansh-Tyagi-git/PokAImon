import{r as d,j as t,u as w,S as j}from"./index-5DV5qeFP.js";const p=["#000000","#EF4444","#F97316","#EAB308","#22C55E","#3B82F6","#8B5CF6","#EC4899","#78716C","#FFFFFF"];function k({onGenerate:x,disabled:m}){const i=d.useRef(null),[c,s]=d.useState(p[0]),a=d.useRef({isDrawing:!1,lastX:0,lastY:0});d.useEffect(()=>{const e=i.current,r=e.getContext("2d"),o=()=>{const u=e.parentElement,g=Math.min(u.clientWidth,u.clientHeight);e.width=g,e.height=g,r.fillStyle="white",r.fillRect(0,0,e.width,e.height),r.lineCap="round",r.lineJoin="round",r.lineWidth=8,r.strokeStyle=c};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[c]),d.useEffect(()=>{const e=i.current,r=e.getContext("2d"),o=n=>{const l=e.getBoundingClientRect();return n.touches&&n.touches.length?{x:n.touches[0].clientX-l.left,y:n.touches[0].clientY-l.top}:{x:n.clientX-l.left,y:n.clientY-l.top}},u=n=>{n.preventDefault(),a.current.isDrawing=!0;const{x:l,y:v}=o(n);a.current.lastX=l,a.current.lastY=v},g=n=>{if(!a.current.isDrawing)return;n.preventDefault();const{x:l,y:v}=o(n);r.beginPath(),r.moveTo(a.current.lastX,a.current.lastY),r.lineTo(l,v),r.strokeStyle=c,r.stroke(),a.current.lastX=l,a.current.lastY=v},h=()=>a.current.isDrawing=!1;return e.addEventListener("mousedown",u),e.addEventListener("mousemove",g),e.addEventListener("mouseup",h),e.addEventListener("mouseleave",h),e.addEventListener("touchstart",u,{passive:!1}),e.addEventListener("touchmove",g,{passive:!1}),e.addEventListener("touchend",h),()=>{e.removeEventListener("mousedown",u),e.removeEventListener("mousemove",g),e.removeEventListener("mouseup",h),e.removeEventListener("mouseleave",h),e.removeEventListener("touchstart",u),e.removeEventListener("touchmove",g),e.removeEventListener("touchend",h)}},[c]);const f=()=>{const e=i.current,r=e.getContext("2d");r.clearRect(0,0,e.width,e.height),r.fillStyle="white",r.fillRect(0,0,e.width,e.height)},y=async()=>{const o=i.current.toDataURL("image/png").split(",")[1];x?.(o)};return t.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg flex flex-col transition-colors",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 text-center text-gray-900 dark:text-white",children:"Doodle Area"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Choose a color:"}),t.jsx("div",{className:"flex flex-wrap gap-3 justify-center",children:p.map(e=>t.jsx("button",{type:"button",onClick:()=>s(e),className:`w-8 h-8 rounded-full border ${e==="#FFFFFF"?"border-gray-400":"border-gray-200"} ${e===c?"ring-2 ring-indigo-600 scale-110":""}`,style:{backgroundColor:e}},e))})]}),t.jsx("div",{className:"relative w-full aspect-square border-2 border-dashed border-gray-300 rounded-xl overflow-hidden touch-none bg-white",children:t.jsx("canvas",{ref:i,className:"absolute inset-0"})}),t.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-4",children:[t.jsx("button",{onClick:f,className:"w-full bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 font-semibold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"Clear Canvas"}),t.jsx("button",{disabled:m,onClick:y,className:"w-full bg-indigo-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:"Generate"})]})]})}const b="https://phpstack-1537842-6027953.cloudwaysapps.com";function C(){const[x,m]=d.useState(!1),[i,c]=d.useState(null),[s,a]=d.useState(null),{apiKey:f}=w(),y=async e=>{try{m(!0),c(null);const r=await fetch(`${b}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doodle_data:e,gemini_api_key:f})});if(!r.ok)throw new Error("Failed to generate");const o=await r.json();a(o)}catch(r){c(r.message)}finally{m(!1)}};return t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 h-full",children:[t.jsx(k,{onGenerate:y,disabled:x}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg flex flex-col items-center justify-center transition-colors",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 text-center text-gray-900 dark:text-white",children:"PokAImon Result"}),t.jsxs("div",{className:"relative w-full aspect-square border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl flex items-center justify-center bg-gray-50 dark:bg-gray-700 overflow-hidden p-2",children:[!s&&!x&&t.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400",children:t.jsx("p",{children:"Your generated PokAImon will appear here."})}),x&&t.jsx(j,{label:"Generating your Pokémon…"}),s&&!x&&t.jsx("img",{src:`${b}${s.image_url}`,alt:s.name,className:"object-contain w-full h-full"})]}),i&&t.jsx("div",{className:"mt-4 text-red-500 dark:text-red-400 text-sm text-center",children:i}),s&&t.jsxs("div",{className:"w-full mt-4 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s.name}),s.type&&t.jsx("span",{className:"text-xs px-2 py-1 rounded bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-200",children:s.type}),s.characteristics&&t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:s.characteristics})]})]})]})}export{C as default};
